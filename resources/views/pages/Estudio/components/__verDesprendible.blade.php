<div class="modal-dialog">
    <form method="post" id="consultarDesprendible">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
            </div>
            <div class="modal-body">

                <div class="scroller" data-always-visible="1" data-rail-visible1="1">

                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-horizontal">
                                <div class="form-group">
                                    <label class="col-sm-3 col-md-10 ">
                                        Pagaduria:
                                    </label>
                                    <div class="col-sm-8 col-md-12">
                                        <select name="pagaduria" class="form-control" id="secretaria">
                                            <option value="00">Seleccione secretaría de educación</option>
                                            <option value="Amazonas">Amazonas</option>
                                            <option value="Antioquia">Antioquia</option>
                                            <option value="Apartado">Apartado</option>
                                            <option value="Arauca">Arauca</option>
                                            <option value="Armenia">Armenia</option>
                                            <option value="Atlantico">Atlantico</option>
                                            <option value="Barrancabermeja">Barrancabermeja</option>
                                            <option value="Barranquilla">Barranquilla</option>
                                            <option value="Bello">Bello</option>
                                            <option value="Bogota">Bogota</option>
                                            <option value="Bolivar">Bolivar</option>
                                            <option value="Boyaca">Boyaca</option>
                                            <option value="Bucaramanga">Bucaramanga</option>
                                            <option value="Buenaventura">Buenaventura</option>
                                            <option value="Buga">Buga</option>
                                            <option value="Caldas">Caldas</option>
                                            <option value="Cali">Cali</option>
                                            <option value="Caqueta">Caqueta</option>
                                            <option value="Cartagena">Cartagena</option>
                                            <option value="Cartago">Cartago</option>
                                            <option value="Casanare">Casanare</option>
                                            <option value="Cauca">Cauca</option>
                                            <option value="Cesar">Cesar</option>
                                            <option value="Chia">Chia</option>
                                            <option value="Choco">Choco</option>
                                            <option value="Cienaga">Cienaga</option>
                                            <option value="Cordoba">Cordoba</option>
                                            <option value="Cucuta">Cucuta</option>
                                            <option value="Cundinamarca">Cundinamarca</option>
                                            <option value="Dosquebradas">Dosquebradas</option>
                                            <option value="Duitama">Duitama</option>
                                            <option value="Envigado">Envigado</option>
                                            <option value="Facatativa">Facatativa</option>
                                            <option value="Florencia">Florencia</option>
                                            <option value="Floridablanca">Floridablanca</option>
                                            <option value="Fusagasuga">Fusagasuga</option>
                                            <option value="Girardot">Girardot</option>
                                            <option value="Giron">Giron</option>
                                            <option value="Guainia">Guainia</option>
                                            <option value="Guaviare">Guaviare</option>
                                            <option value="Huila">Huila</option>
                                            <option value="Ibague">Ibague</option>
                                            <option value="Ipiales">Ipiales</option>
                                            <option value="Itagui">Itagui</option>
                                            <option value="Jamundi">Jamundi</option>
                                            <option value="Guajira">Guajira</option>
                                            <option value="Lorica">Lorica</option>
                                            <option value="Magangue">Magangue</option>
                                            <option value="Magdalena">Magdalena</option>
                                            <option value="Maicao">Maicao</option>
                                            <option value="Malambo">Malambo</option>
                                            <option value="Manizales">Manizales</option>
                                            <option value="Medellin">Medellin</option>
                                            <option value="Meta">Meta</option>
                                            <option value="Monteria">Monteria</option>
                                            <option value="Mosquera">Mosquera</option>
                                            <option value="Narino">Narino</option>
                                            <option value="Neiva">Neiva</option>
                                            <option value="NorteSantander">NorteSantander</option>
                                            <option value="Palmira">Palmira</option>
                                            <option value="Pasto">Pasto</option>
                                            <option value="Pereira">Pereira</option>
                                            <option value="Piedecuesta">Piedecuesta</option>
                                            <option value="Pitalito">Pitalito</option>
                                            <option value="Popayan">Popayan</option>
                                            <option value="Putumayo">Putumayo</option>
                                            <option value="Quibdo">Quibdo</option>
                                            <option value="Quindio">Quindio</option>
                                            <option value="Riohacha">Riohacha</option>
                                            <option value="Rionegro">Rionegro</option>
                                            <option value="Risaralda">Risaralda</option>
                                            <option value="Sabaneta">Sabaneta</option>
                                            <option value="Sahagun">Sahagun</option>
                                            <option value="SanAndres">SanAndres</option>
                                            <option value="SantaMarta">SantaMarta</option>
                                            <option value="Santander">Santander</option>
                                            <option value="Sincelejo">Sincelejo</option>
                                            <option value="Soacha">Soacha</option>
                                            <option value="Sogamoso">Sogamoso</option>
                                            <option value="Soledad">Soledad</option>
                                            <option value="Sucre">Sucre</option>
                                            <option value="Tolima">Tolima</option>
                                            <option value="Tulua">Tulua</option>
                                            <option value="Tumaco">Tumaco</option>
                                            <option value="Tunja">Tunja</option>
                                            <option value="Turbo">Turbo</option>
                                            <option value="Uribia">Uribia</option>
                                            <option value="Valle">Valle</option>
                                            <option value="Valledupar">Valledupar</option>
                                            <option value="Vaupes">Vaupes</option>
                                            <option value="Vichada">Vichada</option>
                                            <option value="Villavicencio">Villavicencio</option>
                                            <option value="Yopal">Yopal</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="form-horizontal">
                                <div class="form-group">
                                    <label class="col-sm-2 col-md-6 ">
                                        Cedula:
                                    </label>
                                    <div class="col-sm-8 col-md-12">
                                        <input type="text" id="id_nombre"
                                               name="cedula" value="{{$cedula}}" maxlength="30"
                                               class="form-control input-circle address">
                                    </div>
                                </div>
                            </div>
                            <div class="form-horizontal">
                                <div class="form-group">
                                    <label class="col-sm-2 col-md-6 ">
                                        Mes:
                                    </label>
                                    <div class="col-sm-8 col-md-12">
                                        <select name="mes" class="form-control">
                                            <option value="00">Seleccione mes</option>
                                            <option value="01">Enero</option>
                                            <option value="02">Febrero</option>
                                            <option value="03">Marzo</option>
                                            <option value="04">Abril</option>
                                            <option value="05">Mayo</option>
                                            <option value="06">Junio</option>
                                            <option value="07">Julio</option>
                                            <option value="08">Agosto</option>
                                            <option value="09">Septiembre</option>
                                            <option value="10">Octubre</option>
                                            <option value="11">Noviembre</option>
                                            <option value="12">Diciembre</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-horizontal">
                                <div class="form-group">
                                    <label class="col-sm-3 col-md-10 ">
                                        Año:
                                    </label>
                                    <div class="col-sm-8 col-md-12">
                                        <select name="anio" class="form-control">
                                            <option value="00">Seleccione año</option>
                                            <option value="2010">2010</option>
                                            <option value="2011">2011</option>
                                            <option value="2012">2012</option>
                                            <option value="2013">2013</option>
                                            <option value="2014">2014</option>
                                            <option value="2015">2015</option>
                                            <option value="2016">2016</option>
                                            <option value="2017">2017</option>
                                            <option value="2018">2018</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="form-horizontal">
                                <div class="form-group">
                                    <label class="col-sm-2 col-md-6 ">
                                        Clave:
                                    </label>
                                    <div class="col-sm-8 col-md-12">
                                        <input type="text" id="id_nombre"
                                               name="clave" maxlength="30"
                                               class="form-control input-circle address">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="volante-data" style="height: 200px; overflow-y: auto" class="container-fluid">

                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="submit" id="btGuardar" name="btGuardar" class="btn green">Consultar</button>
                <button type="button" class="btn dark btn-outline" data-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </form>
</div>

<script type="text/javascript">
    function table(title, o, total) {
        data = `<div class="portlet box main-color sinMarginBottom">
                    <div style="text-align: center; padding: 0px !important; min-height: 0px!important;" class="portlet-title" >
                        <strong style="font-size: 1.4em">${title}</strong>
                    </div>
                    <div class="portlet-body">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="row">
                                    <div class="comments-list">
                                        <table class="table">
                                        <thead>
                                        <tr style="text-align: center !important;">
                                            <th style="text-align: center !important;" scope="col">COD</th>
                                            <th class="hidden-xs" style="text-align: center !important;" scope="col">CONCEPTO</th>
                                            <th style="text-align: center !important;" scope="col">VALOR</th>
                                        </tr>
                                        </thead>
                                        <tbody >`;
        o.map(e => {
            data += `<tr>
                    <td>${e.con_concepto}</td>
                    <td>${e.concepto}</td>
                    <td><b>${format_miles(e.valor)}</b></td>
                </tr>`;
        });
        data += `<tr>
                <td></td>
                <td>Total</td>
                <td><b>${format_miles(total)}</b></td>
            </tr>`;
        data += `</tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    </div>`;


        return data;


    }

    function processObject(o) {
        data = `<div>
               <p><b>Nombre: </b>${o.nombre}</p>
               <p><b>Documento: </b>${format_miles(o.documento)}</p>
               <p><b>Salario basico: </b>${format_miles(o.salario_basico)}</p>
               <p><b>Periodo: </b>${o.periodo}</p>
               <p><b>Tipo de contrato: </b>${o.tipo_contrato}</p>
            </div>`;
        data += `<br>`;
        data += table("INGRESOS", o.ingresos, o.ingresos_totales);
        data += `<br>`;
        data += table("EGRESOS", o.egresos, o.egresos_totales);
        return data;
    }

    $('#consultarDesprendible').submit(function (e) {
        e.preventDefault();
        data = $(this).serialize();
        fetch('http://smc.upgradecrediticio.com/aliados/connect-pagaduria?' + data)
            .then(r => {
                    if (r.status == 500) {
                        alert("Datos incorrectos, el volante no pudo ser consultado");
                    } else {
                        r.json().then(r => {
                            $('#volante-data').html(processObject(r))
                        })
                    }
                }
            );
    })
</script>